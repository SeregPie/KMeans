(function(a){"undefined"!=typeof module&&"undefined"!=typeof exports&&this===exports?module.exports=a({}):(this.almete=this.almete||{},a(this.almete))}).call(this,function(a){let b=function(a,b){a=a.slice();let c=a.length;b=Math.min(b,c);let d=[];for(;b--;){let b=Math.floor(Math.random()*c),e=a.splice(b,1)[0];c--,d.push(e)}return d},c=function(a){return a.reduce((a,b)=>a+b,0)},d=function(a){return c(a)/a.length},e=function(a,b){let c,d=1/0;for(let e=a.length;e--;){let f=a[e],g=b(f);g<d&&(d=g,c=f)}return c},f=function(a,...b){return a.map((a,c)=>[a,...b.map(a=>a[c])])},g=function(a,b){return a===b||!(!Array.isArray(a)||!Array.isArray(b)||a.length!==b.length)&&f(a,b).every(([a,b])=>g(a,b))},i=function(a){if(0!==a.length)return a[0].map((b,c)=>d(a.map(a=>a[c])))},j=function(a,b){let c=0;for(let d=Math.min(a.length,b.length);d--;)c+=Math.pow(a[d]-b[d],2);return Math.sqrt(c)};return a.KMeans=function(a,c,{maxIterations:maxIterations=1024,toVector:toVector=h()}={}){if(maxIterations<=0)return[];let d=a.length;if(d<=0)return[];let k,l=a;if(Array.isArray(c)){if((k=c.length)<=0)return[];if(1===k)return[l];a=a.map(a=>toVector(a)),c=c.map(a=>toVector(a))}else{if((k=c)<=0)return[];if(1===k)return[l];if(k>=d){let a=l.map(a=>[a]),b=Array.from({length:k-d},()=>[]);return a.concat(b)}a=a.map(a=>toVector(a)),c=b(a,k)}let n,m=f(l,a);for(let a=!0;a&&maxIterations--;)n=c.map(a=>[[],[],a]),m.forEach(([a,b])=>{let[c,d]=e(n,([a,c,d])=>j(b,d));c.push(a);d.push(b)}),a=!1,c=n.map(([b,c,d])=>{let e=i(c);g(d,e)||(a=!0);return e});return n.map(([a])=>a)}});