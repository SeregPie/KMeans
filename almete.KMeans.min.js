(function(a){"undefined"!=typeof module&&"undefined"!=typeof exports&&this===exports?module.exports=a({}):(this.almete=this.almete||{},a(this.almete))}).call(this,function(a){let b=function(a,b){a=a.slice();let c=a.length;b=Math.min(b,c);let d=[];for(;b--;){let b=Math.floor(Math.random()*c),e=a.splice(b,1)[0];c--,d.push(e)}return d},c=function(a,b){let c,d=1/0;for(let e=a.length;e--;){let f=a[e],g=b(f);g<d&&(d=g,c=f)}return c},d=function(a,...b){return a.map((a,c)=>[a,...b.map(a=>a[c])])},e=function(a,b){return a===b||!(!Array.isArray(a)||!Array.isArray(b)||a.length!==b.length)&&d(a,b).every(([a,b])=>e(a,b))},g=function(a){let b=a.length;if(b){let c=b-1;return a[c].map((d,e)=>{for(let b=c;b--;)d+=a[b][e];return d/b})}},h=function(a,b){let c=0;for(let d=Math.min(a.length,b.length);d--;)c+=Math.pow(a[d]-b[d],2);return Math.sqrt(c)};return a.KMeans=function(a,i,{maxIterations:maxIterations=1024,toVector:toVector=f()}={}){if(!maxIterations)return[];let j=a.length;if(!j)return[];let k,l=a;if(Array.isArray(i)){if(!(k=i.length))return[];if(1===k)return[l];a=a.map(a=>toVector(a)),i=i.map(a=>toVector(a))}else{if(!(k=i))return[];if(1===k)return[l];if(k>=j){let a=l.map(a=>[a]),b=Array.from({length:k-j},()=>[]);return[...a,...b]}a=a.map(a=>toVector(a)),i=b(a,k)}let n,m=d(l,a);for(let a=!0;a&&maxIterations--;)n=i.map(a=>[[],[],a]),m.forEach(([a,b])=>{let[d,e]=c(n,([a,c,d])=>h(b,d));d.push(a);e.push(b)}),a=!1,i=n.map(([b,c,d])=>{let f=g(c);if(!f)return d;e(d,f)||(a=!0);return f});return n.map(([a])=>a)}});